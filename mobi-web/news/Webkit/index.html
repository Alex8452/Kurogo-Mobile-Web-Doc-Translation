<?php
$page->title("News")
     ->navbar_image("news")
     ->generate_navigation($newsURL->breadCrumbs("News", "Search"))
     ->add_stylesheet("Webkit/list")
     ->add_javascript("Webkit/home");

$page->content_begin();
?>

<div class="header">
    <div id="category-switcher">
         <? if($newsURL->isHome()) {?>
            <form method="get" id="category-form">
                <span class="formlabel">Section:</span>
                <select class="newsinput" id="category_id" name="category_id" onchange="loadCategory(this);">
                        <? foreach($categories as $id => $title) { ?>
                            <? if($newsURL->categoryId() == $id) { ?>
                                <option value="<?=$id?>" selected="true"><?=$title?></option>
                            <? } else { ?>
                                <option value="<?=$id?>"><?=$title?></option>
                            <? } ?>
                        <? } ?>
                </select>
            </form>

         <? } ?>

         <form id="search-form" <? if($newsURL->isHome()) {?>style="display:none;"<? } ?> >
             <span class="formlabel">Search:</span>
               <input class="newsinput search-field" type="text" name="search_terms" value="<?=$newsURL->searchTerms()?>"/>
               <?=$newsURL->hiddenHomeStateForm()?>
               <? if($newsURL->isSearchResults()) { ?>
                    <input class="submit-search" "type="submit" value="Search" />
               <? } ?>
         </form>

         <? if($newsURL->isHome()) { ?>
            <button id="toggle-search-button" onclick="toggleSearch();">Search</button>
         <? } ?>
    </div>
</div>

    <ul class="results">

        <? if($previous_url) { ?>
            <li class="non-story">
                <a href="<?=$previous_url?>">Previous stories</a>
            </li>
        <? } ?>

        <? foreach($stories as $story) { ?>
            <li class="story">
                <? if($story['image']) { ?>
                    <img class="thumbnail" src="<?=$story['image']['url']?>" />
                <? } else { ?>
                    <img class="thumbnail" src="news-placeholder.png" />
                <? } ?>
                     <a href="<?=$newsURL->storyURL($story)?>">
                        <?=$story["title"]?><br />
                        <span class="smallprint"><?=webkit_deck($story)?></span>
                     </a>
            </li>
        <? } ?>

        <? if($next_url) { ?>
            <li class="non-story">
                <a href="<?=$next_url?>">More stories</a>
            </li>
        <? } ?>
    </ul>



<?
$page->content_end();
?>
