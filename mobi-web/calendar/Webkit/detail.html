<?php

$page->title("Events: Event Details")
     ->navbar_image('calendar')
     ->breadcrumbs('Browse', "Details");

// get a list of the category mappings first
$harvard_cat = Harvard_Calendar::get_categories(PATH_TO_EVENTS_CAT);

$page->content_begin();
?>
	<div class="focal ">
		<h2><?=$event->get_summary()?></h2>
	
		<ul class="nav">
			<li><?=$date_str?><br/><?=$time_of_day?></li>

                        <? if(briefLocation($event)) { ?>
 			   <li><a href="<?=mapURL(briefLocation($event))?>" class="map"><?=briefLocation($event)?></a></li>
                        <? } ?>

			<li class="description"><?=$event->get_description()?></li>
 
                        <? if(isset($event->infophone)) { ?>
 			   <li><a href="<?=phoneURL($event->infophone)?>" class="phone"><?=str_replace('-', '-&shy;', $event->infophone)?></a></li>
                        <? } ?>
                       
                        <? if(isset($event->infourl)) { ?>
                           <li><a href="<?=$event->urlize?>" class="external" target="_new"><?=$event->infourl?></a></li>
                        <? } ?>
		</ul>
	
		<p class="legend">Categorized as: 
                   <? $size = count($categories);
                      foreach($categories as $index => $category) { $last = ($size-1 == $index);
                          foreach($harvard_cat as $cat) {
								// The strings from $harvard_cat may be null-terminated, unlike the usual PHP strings, so trim before comparing.
                                if (strcmp(trim($cat->get_name()), trim($category)) == 0) {
                                     $categoryFound = $cat;
                                     break;
                              }
                             }
        ?>
                        <a href="<?=categoryURL($categoryFound)?>"><?=ucname($category)?></a><? if(!$last) { echo ","; } ?>
                   <? } ?>
                </p>
	</div>

<? $page->content_end(); ?>
