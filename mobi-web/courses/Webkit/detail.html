<?php
$page->title("Courses: Details")
     ->header("Details")
     ->navbar_image('stellar')
     ->add_javascript('../Webkit/uiscripts');

//construct the breadcrumbs
if ($back == 'School|Listing') {
  $courseGroup = stripslashes($_REQUEST['courseGroup']);
  $courseID = stripslashes($_REQUEST['courseID']);
  
  $page->breadcrumbs('School', 'Listing', 'Detail');
  $page->breadcrumb_links(
    'courses.php?which='.urlencode($courseGroup), 
    'course.php?id='.urlencode($courseID).'&courseGroup='.urlencode($courseGroup).'&back=School');
} else if ($back == 'Listing') {
  $courseID = stripslashes($_REQUEST['courseID']);
  
  $page->breadcrumbs('Listing', 'Detail');
  $page->breadcrumb_links('course.php?id='.urlencode($courseID).'&courseGroup='.urlencode($courseID));

} else if ($back == 'Search') {
  $filter = stripslashes($_REQUEST['filter']);

  $page->breadcrumbs('Search', 'Detail');
  $page->breadcrumb_links('search.php?filter='.urlencode($filter));  
}

$page->inline_css_begin();
require $page->delta_file('mystellar', 'css');
$page->inline_css_end();
$page->inline_js_begin();
require $page->delta_file('mystellar', 'js');
$page->inline_js_end();
$page->content_begin();
?>
<a name="scrolldown"> </a>

<div class="focal shaded">
    <a id="mystellar" class="<?=$toggle?>" onclick="toggleMyStellar(this, '<?=$class_data?>')"></a>
    <h2><?=$class['name']?>: <?=className($class)?></h2>
	<p class="address"><?=$term?></p>
    <ul id="tabs">
    <? if (!$no_stellar_site) { ?>
        <li class="active"><a href="#scrolldown" onclick="showTab('infotab',this)">Info</a></li>
        <li><a href="#scrolldown" onclick="showTab('instructortab',this)">Instructor(s)</a></li>
    <? } else { ?>
        <li class="active">Info</li>
        <li class="greyedout">Instructor(s)</li>
    <? } ?>
    </ul>

    <div id="tabbodies">
        <div class="tabbody" id="infotab"<? if (!$no_stellar_site) { ?> style="display:none"<? } ?>>
            <ul class="nav">
            <?
            $meetingTimes = $class['meeting_times'];
            if ($meetingTimes->parseSucceeded()) {
                foreach ($meetingTimes->all() as $meetingTime) {
                    echo("<li>");
                    if ($meetingTime->isLocationKnown()) {
                        echo("<a class=\"map\" href=\"" . mapURL($meetingTime->locationText()) . "\">" .
                              $meetingTime->daysText() . " " . $meetingTime->timeText() .
                              " (" . $meetingTime->locationText() . ")</a>");
                    }
                    else {
                         echo($meetingTime->daysText() . " " . $meetingTime->timeText() .
                              " (" . $meetingTime->locationText() . ")");
                    }
                    echo("</li>");
                }
            }
            else {
                echo("<li>" . $meetingTimes->rawTimesText() . " " . $meetingTimes->rawLocationsText() . "</li>");
            }
            ?>
                <li>
                    <h3>Description:</h3>
                    <p><?=htmlentities($class['description'])?></p>
                </li>
            </ul>
        </div> <!-- id="infotab" -->
    
    <? if (!$no_stellar_site) { ?>
        <div class="tabbody" id="instructortab" style="display:none">
            <ul class="nav">
                <li><h3>Instructor(s):</h3></li>
            <? foreach($class['staff']['instructors'] as $instruct) { ?>
                <li><a href="<?=personURL($instruct)?>" class="people"><?=$instruct?></a></li>
            <? } ?>

            <? if(count($class['staff']['tas'])) { ?>
                <li><h3>TAs:</h3></li>
                <? foreach($class['staff']['tas'] as $TA) { ?>
                    <li><a href="<?=personURL($TA)?>" class="people"><?=$TA?></a></li>
                <? } ?>
            <? } ?>
            </ul>
        </div> <!-- id="instructortab" -->

        <div class="clear"></div>
    <? } ?>
    </div> <!-- id="tabbodies" -->

</div> <!-- class="focal shaded" -->
<?
$page->content_end();
$page->footer_script('showTab("infotab");')
?>
